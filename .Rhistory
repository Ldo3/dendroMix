plot(sim.data$X[,2],sim.data$y)
source("~/Documents/Prof Dat/FMNBR_Bayesian .R")
p_star = c(0.2,0.8)
phi_star=c(20,10)
e0=1
s=replicate(d+1,1)
Sigma= diag(s)
shape0=0.01
rate0=0.01
linh<-FMNBR(sim.data$X,sim.data$y,k=2, phi_star, theta0, shape0,rate0, e0, Sigma, 200)
linh<-FMNBR(sim.data$X,sim.data$y,k=2,p_star, phi_star, theta0, shape0,rate0, e0, Sigma, 200)
linh[[200]]
linh[[98]]
linh[[99]]
linh[[199]]
linh[[198]]
linh<-FMNBR(sim.data$X,sim.data$y,k=2,p_star, phi_star, theta0, shape0,rate0, e0, Sigma, 2000)
linh<-FMNBR(sim.data$X,sim.data$y,k=2,p_star, phi_star, theta0, shape0,rate0, e0, Sigma, 2000)
linh<-FMNBR(sim.data$X,sim.data$y,k=2,p_star, phi_star, theta0, shape0,rate0, e0, Sigma, 261)
linh<-FMNBR(sim.data$X,sim.data$y,k=2,p_star, phi_star, theta0, shape0,rate0, e0, Sigma, 261)
linh<-FMNBR(sim.data$X,sim.data$y,k=2,p_star, phi_star, theta0, shape0,rate0, e0, Sigma, 261)
linh<-FMNBR(sim.data$X,sim.data$y,k=2,p_star, phi_star, theta0, shape0,rate0, e0, Sigma, 240)
linh<-FMNBR(sim.data$X,sim.data$y,k=2,p_star, phi_star, theta0, shape0,rate0, e0, Sigma, 100)
linh<-FMNBR(sim.data$X,sim.data$y,k=2,p_star, phi_star, theta0, shape0,rate0, e0, Sigma, 100)
linh[[100]]
linh<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, linh[[100]]$phi, linh[[100]]$theta, shape0,rate0, e0, Sigma, 10)
linh<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, linh[[100]]$phi, linh[[100]]$theta, shape0,rate0, e0, Sigma, 100)
linh<-FMNBR(sim.data$X,sim.data$y,k=2,p_star, phi_star, theta0, shape0,rate0, e0, Sigma, 100)
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, linh[[100]]$phi, linh[[100]]$theta, shape0,rate0, e0, Sigma, 100)
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, linh[[100]]$phi, linh[[100]]$theta, shape0,rate0, e0, Sigma, 50)
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, linh[[100]]$phi, linh[[100]]$theta, shape0,rate0, e0, Sigma, 90)
linh2[[90]]
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, linh[[100]]$phi, linh[[100]]$theta, shape0,rate0, e0, Sigma, 100)
linh2[[100
]]
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, linh[[100]]$phi, linh[[100]]$theta, shape0,rate0, e0, Sigma, 1000)
linh2[[1000]]
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, linh[[100]]$phi, linh[[100]]$theta, shape0,rate0, e0, Sigma, 5000)
source("~/Documents/Prof Dat/FMNBR_Bayesian .R")
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, linh[[100]]$phi, linh[[100]]$theta, shape0,rate0, e0, Sigma, 5000)
phi_star=c(10,1)
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, phi_star, linh[[100]]$theta, shape0,rate0, e0, Sigma, 1)
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, phi_star, linh[[100]]$theta, shape0,rate0, e0, Sigma, 3)
phi_star=c(10,0.1)
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, phi_star, linh[[100]]$theta, shape0,rate0, e0, Sigma, 3)
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, phi_star, linh[[100]]$theta, shape0,rate0, e0, Sigma, 50)
linh2[[50]]
source("~/Documents/Prof Dat/FMNBR_Bayesian .R")
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, phi_star, linh[[100]]$theta, shape0,rate0, e0, Sigma, 50)
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,linh[[100]]$p, phi_star, linh[[100]]$theta, shape0,rate0, e0, Sigma, 1000)
source("~/Documents/Prof Dat/FMNBR_Bayesian .R")
linh3<-FinalMH(linh2, 500,1000)
p = as.matrix(linh3$p)
linh3$p
p = as.data.frame(linh3$p)
p
View(p)
re.p<-matrix(0,length(linh2),2)
for (i in 1:length(linh2))
{
for (j in 1:k)
{
re.p[i,j]=linh2[[i]][[2]][j]
}
}
re.p<-matrix(0,length(linh2),2)
for (i in 1:length(linh2))
{
for (j in 1:2)
{
re.p[i,j]=linh2[[i]][[2]][j]
}
}
View(re.p)
re.pi<-re.pi[-(1:500),]
re.p<-re.p[-(1:500),]
mean(re.p[,1])
mean(re.p[,2])
re.p[1,1]+re.p[1,2]
re.p<-matrix(0,length(linh2),2)
for (i in 1:length(linh2))
{
for (j in 1:2)
{
re.p[i,j]=linh2[[i]][[1]][j]
}
}
re.p[1,1]+re.p[1,2]
re.p<-re.p[-(1:500),]
re.p[1,1]+re.p[1,2]
mean(re.p[,1])
mean(re.p[,2])
re.phi<-matrix(0,length(linh2),2)
for (i in 1:length(linh2))
{
for (j in 1:2)
{
re.phi[i,j]=linh2[[i]][[2]][j]
}
}
re.p<-re.p[-(1:500),]
re.phi<-re.phi[-(1:500),]
mean(re.phi[,1])
mean(re.phi[,2])
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,p0, phi_star, theta0, shape0,rate0, e0, Sigma, 5000)
re.p<-matrix(0,length(linh2),2)
for (i in 1:length(linh2))
{
for (j in 1:2)
{
re.p[i,j]=linh2[[i]][[1]][j]
}
}
re.phi<-matrix(0,length(linh2),2)
for (i in 1:length(linh2))
{
for (j in 1:2)
{
re.phi[i,j]=linh2[[i]][[2]][j]
}
}
re.p<-re.p[-(1:2500),]
re.phi<-re.phi[-(1:2500),]
mean(re.p[,1])
mean(re.p[,2])
mean(re.phi[,1])
mean(re.phi[,2])
1/mean(re.phi[,2])
r=2
proposal_function = function(eta){
return(rgamma(1,shape=r,rate=r/eta))
}
eta0=1/phi0
proposal_function(eta0[1])
proposal_function(eta0[1])
proposal_function(eta0[1])
proposal_function(eta0[1])
proposal_function(eta0[1])
proposal_function(eta0[1])
proposal_function(eta0[1])
proposal_function(eta0[1])
proposal_function(eta0[1])
proposal_function(eta0[1])
proposal_function(eta0[1])
proposal_function(eta0[1])
source("~/Documents/Prof Dat/FMNBR_Bayesian .R")
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,p0, phi_star, theta0, shape0,rate0, e0, Sigma, 5000)
source("~/Documents/Prof Dat/FMNBR_Bayesian .R")
source("~/Documents/Prof Dat/FMNBR_Bayesian .R")
linh2<-FMNBR(sim.data$X,sim.data$y,k=2,p0, phi_star, theta0, shape0,rate0, e0, Sigma, 5000)
re.p<-matrix(0,length(linh2),2)
for (i in 1:length(linh2))
{
for (j in 1:2)
{
re.p[i,j]=linh2[[i]][[1]][j]
}
}
re.phi<-matrix(0,length(linh2),2)
for (i in 1:length(linh2))
{
for (j in 1:2)
{
re.phi[i,j]=linh2[[i]][[2]][j]
}
}
re.p<-re.p[-(1:2500),]
re.phi<-re.phi[-(1:2500),]
mean(re.p[,1])
mean(re.p[,2])
mean(re.phi[,1])
r=2
proposal_function = function(eta){
return(rgamma(1,shape=r,rate=r/eta))
}
eta=proposal_function(eta0[1])
1/eta
eta=proposal_function(eta)
eta=proposal_function(eta)
eta=proposal_function(eta)
eta=proposal_function(eta)
eta=proposal_function(eta)
eta=proposal_function(eta)
eta=proposal_function(eta)
eta=proposal_function(eta)
eta=proposal_function(eta)
eta=proposal_function(eta)
eta=proposal_function(eta)
1/eta
s = replicate(d+1, 1)
Sigma = diag(s)
proposal_function_theta <-function(theta, Sigma)
{
theta.p = rmvnorm(1,mean = theta, sigma = Sigma, method = "chol")
}
d
s = replicate(d+1, 1)
Sigma = diag(s)
proposal_function_theta <-function(theta, Sigma)
{
theta.p = rmvnorm(1,mean = theta, sigma = Sigma, method = "chol")
}
proposal_function_theta(theta0,Sigma)
s
Sigma
theta0
proposal_function_theta(theta0[1,],Sigma)
proposal_function_theta(theta0[1,],Sigma)
s = replicate(d+1, 1)
Sigma = diag(s)
proposal_function_theta <-function(theta, Sigma)
{
theta.p = rmvnorm(1,mean = theta, sigma = Sigma, method = "chol")
}
s = replicate(d+1, 1)
Sigma = diag(s)
proposal_function_theta <-function(theta, Sigma)
{
theta.p = rmvnorm(1,mean = theta, sigma = Sigma, method = "chol")
}
proposal_function_theta(theta0[1,],Sigma)
proposal_function_theta <-function(theta, Sigma)
{
theta.p = rmvnorm(1,mean = theta, sigma = Sigma, method = "chol")
}
Signa
Sigma
proposal_function_theta(theta0[1,],Sigma)
a=proposal_function_theta(theta0[1,],Sigma)
a
delta0<-matrix(0,n,k)
for(j in 1:k)
{
for(i in 1:n)
{
delta0[i,j]=exp.log.nbinom.p(p0[j],y[i],X[i,],eta0[j],theta0[j,])
}
}
for(i in 1:n)
{ s=sum(delta0[i,])
for(j in 1:k)
{
delta0[i,j]=delta0[i,j]/s
}
}
### Generate vector z
Pro<-list()
for (i in 1:n)
{ Pro[[i]]=delta0[i,]
}
z<-c()
for (i in 1:n)
{z[i]=sample(1:k,size = 1, prob=Pro[[i]] )
}
d = dim(theta0)[2]-1
n = length(y)
eta0 = 1/phi0
data_list=list()
accept.eta = 0
accept.theta =0
exp.log.nbinom.p<-function(p,y,X,eta,theta)
{
phi = 1/eta
#X is a vector, theta is a vector
#elg = exp(lgamma(y+1/eta)-lgamma(y+1)-lgamma(1/eta)+y*(X%*%theta)-(y+1/eta)*log(exp(X%*%theta)+1/eta)-(1/eta)*log(eta))
elg = p*dnbinom(y,size = phi, mu= exp(X%*%theta))
return(elg)
}
log.nbinom<-function(y,X,eta,theta)
{
phi = 1/eta
#x is a vector, theta is a vector
#elg = exp(log(p)+lgamma(y+1/eta)-lgamma(y+1)-lgamma(1/eta)+y*(X%*%theta)-(y+1/eta)*log(exp(X%*%theta)+1/eta)-(1/eta)*log(eta))
elg = dnbinom(y,size = phi, mu= exp(X%*%theta), log = TRUE)
return(elg)
}
delta0<-matrix(0,n,k)
for(j in 1:k)
{
for(i in 1:n)
{
delta0[i,j]=exp.log.nbinom.p(p0[j],y[i],X[i,],eta0[j],theta0[j,])
}
}
for(i in 1:n)
{ s=sum(delta0[i,])
for(j in 1:k)
{
delta0[i,j]=delta0[i,j]/s
}
}
X=sim.data$X
y=sim.data$y
d = dim(theta0)[2]-1
n = length(y)
eta0 = 1/phi0
data_list=list()
accept.eta = 0
accept.theta =0
delta0<-matrix(0,n,k)
for(j in 1:k)
{
for(i in 1:n)
{
delta0[i,j]=exp.log.nbinom.p(p0[j],y[i],X[i,],eta0[j],theta0[j,])
}
}
for(i in 1:n)
{ s=sum(delta0[i,])
for(j in 1:k)
{
delta0[i,j]=delta0[i,j]/s
}
}
### Generate vector z
Pro<-list()
for (i in 1:n)
{ Pro[[i]]=delta0[i,]
}
z<-c()
for (i in 1:n)
{z[i]=sample(1:k,size = 1, prob=Pro[[i]] )
}
k=2
delta0<-matrix(0,n,k)
for(j in 1:k)
{
for(i in 1:n)
{
delta0[i,j]=exp.log.nbinom.p(p0[j],y[i],X[i,],eta0[j],theta0[j,])
}
}
for(i in 1:n)
{ s=sum(delta0[i,])
for(j in 1:k)
{
delta0[i,j]=delta0[i,j]/s
}
}
### Generate vector z
Pro<-list()
for (i in 1:n)
{ Pro[[i]]=delta0[i,]
}
z<-c()
for (i in 1:n)
{z[i]=sample(1:k,size = 1, prob=Pro[[i]] )
}
z
count<-replicate(k,0)
for (j in 1:k)
{  for (i in 1:n)
{
if(z[i]==j) {count[j]=count[j]+1}
else {count[j]=count[j]}
}
}
index = list()
for (j in 1:k)
{
index[[j]]=0
}
for (j in 1:k)
{
for (i in 1:n)
{
if(z[i]==j){index[[j]]=append(index[[j]],i)}else{index[[j]]=index[[j]]}
}
}
for(j in 1:k)
{index[[j]]=index[[j]][-1]}
index
source("~/Documents/Prof Dat/FMNBR_Bayesian .R")
linh<-FMNBR(X,y,k=2,p0=c(0.3,0.7),phi0=c(10,10),theta0,shape0,rate0,e0,Sigma,5000)
source("~/Documents/Prof Dat/FMNBR_Bayesian .R")
linh<-FMNBR(X,y,k=2,p0=c(0.3,0.7),phi0=c(10,10),theta0,shape0,rate0,e0,Sigma,5000)
warnings()
e1<-e0+count
p1<-rdirichlet(1,e1)
r=2
proposal_function = function(eta){
return(rgamma(1,shape=r,rate=r/eta))
}
##### Accept function for eta | theta0
eta1=c()
for (j in 1:k)
{
l.eta.prop=c()
l.eta.cur=c()
eta.prop = proposal_function(eta0[j])
for(i in 1:index[[j]])
{
l.eta.prop[i] = log.nbinom(y[i],X[i,],eta.prop,theta0[j,])
l.eta.cur[i] = log.nbinom(y[i],X[i,], eta0[j], theta0[j,])
}
l.eta.prop = sum(l.eta.prop)+(shape0-1)*log(eta.prop)-rate0*eta.prop
l.eta.cur = sum(l.eta.cur)+(shape0-1)*log(eta0[j])-rate0*eta0[j]
logA = l.eta.prop - l.eta.cur +dgamma(eta0[j], r, rate=r/eta.prop, log = TRUE) - dgamma(eta.prop, r, rate=r/(eta0[j]), log = TRUE)
if(logA >=0 || runif(1)<exp(logA)){eta1[j]= eta.prop
}else{eta1[j]=eta0[j]}
}
eta1=c()
for (j in 1:k)
{
l.eta.prop=c()
l.eta.cur=c()
eta.prop = proposal_function(eta0[j])
for(i in 1:count[j])
{
l.eta.prop[i] = log.nbinom(y[index[[j]][i]],X[index[[j]][i],],eta.prop,theta0[j,])
l.eta.cur[i] = log.nbinom(y[index[[j]][i]],X[index[[j]][i],], eta0[j], theta0[j,])
}
l.eta.prop = sum(l.eta.prop)+(shape0-1)*log(eta.prop)-rate0*eta.prop
l.eta.cur = sum(l.eta.cur)+(shape0-1)*log(eta0[j])-rate0*eta0[j]
logA = l.eta.prop - l.eta.cur +dgamma(eta0[j], r, rate=r/eta.prop, log = TRUE) - dgamma(eta.prop, r, rate=r/(eta0[j]), log = TRUE)
if(logA >=0 || runif(1)<exp(logA)){eta1[j]= eta.prop
}else{eta1[j]=eta0[j]}
}
source("~/Documents/Prof Dat/FMNBR_Bayesian .R")
linh<-FMNBR(X,y,k=2,p0=c(0.3,0.7),phi0=c(10,10),theta0,shape0,rate0,e0,Sigma,5000)
source("~/Documents/Prof Dat/FMNBR_Bayesian .R")
linh<-FMNBR(X,y,k=2,p0=c(0.3,0.7),phi0=c(10,10),theta0,shape0,rate0,e0,Sigma,5000)
re.p<-matrix(0,length(linh),2)
for (i in 1:length(linh))
{
for (j in 1:2)
{
re.p[i,j]=linh[[i]][[1]][j]
}
}
re.phi<-matrix(0,length(linh),2)
for (i in 1:length(linh))
{
for (j in 1:2)
{
re.phi[i,j]=linh[[i]][[2]][j]
}
}
re.p<-re.p[-(1:2500),]
re.phi<-re.phi[-(1:2500),]
mean(re.p[1])
mean(re.p[2])
mean(re.p[,1])
mean(re.p[,2])
mean(re.phi[,1])
mean(re.phi[,2])
linh[[5000]]$theta
linh[[2000]]$theta
re.theta1<-matrix(0, length(linh),3)
for ( i in 1:length(linh))
{
for(j in 1:3)
{
re.theta1[i,j]=linh[[i]]$theta[1,j]
}
}
View(re.theta1)
View(theta0)
re.theta2<-matrix(0,length(linh),3)
for ( i in 1:length(linh))
{
for(j in 1:3)
{
re.theta2[i,j]=linh[[i]]$theta[2,j]
}
}
View(re.theta2)
re.theta1<-re.theta1[-(1:2500),]
re.theta2<-re.theta2[-(1:2500),]
mean(re.theta1[,1])
mean(re.theta1[,2])
mean(re.theta1[,3])
mean(re.theta2[,1])
mean(re.theta2[,2])
mean(re.theta2[,3])
rm(list=ls())
source("~/Documents/Prof Dat/generating data .R")
plot(sim.data$X[,2],sim.data$y)
plot(sim.data$X[,2],sim.data$y)
curve(exp(4*x),col=red, add=TRUE)
curve(exp(6*x),col=green,add=TRUE)
plot(sim.data$X[,2],sim.data$y)
curve(exp(4*x),col="red", add=TRUE)
curve(exp(6*x),col="green",add=TRUE)
plot(sim.data$X[,2],sim.data$y)
curve(exp(4*x),col="red", add=TRUE)
curve(exp(-6*x),col="green",add=TRUE)
X<-sim.data$X
View(X)
X[1,]%*%theta0[1,]
4*X[1,2]
source("~/Documents/Prof Dat/generating data .R")
source("~/Documents/Prof Dat/generating data .R")
source("~/Documents/Prof Dat/generating data .R")
source("~/Documents/Prof Dat/generating data .R")
log(3/2)
setwd("~/Documents/Prof_Dat/dendroMix")
rm(list=ls())
getwd()
file.exists("DESCRIPTION")
read.dcf("DESCRIPTION")[, "Package"]    # should print your package name
dir.exists("R")
devtools::document()    # updates man/*.Rd and NAMESPACE
pkgdown::build_site(lazy = FALSE)
# (or, if only function docs changed)
# pkgdown::build_reference(lazy = FALSE)
devtools::document()    # updates man/*.Rd and NAMESPACE
pkgdown::build_site(lazy = FALSE)
devtools::document()    # updates man/*.Rd and NAMESPACE
pkgdown::build_site(lazy = FALSE)
pkgdown::build_site(lazy = FALSE)
pkgdown::build_site()
